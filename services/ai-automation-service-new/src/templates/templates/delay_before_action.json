{
  "template_id": "delay_before_action",
  "version": 1,
  "description": "Automation with delay before executing action",
  "required_capabilities": {
    "sensors": [],
    "devices": [],
    "services": []
  },
  "parameter_schema": {
    "trigger_type": {
      "type": "string",
      "enum": ["state", "time", "numeric_state"],
      "required": true,
      "description": "Type of trigger"
    },
    "trigger_entity": {
      "type": "string",
      "required": false,
      "description": "Entity ID for state triggers"
    },
    "trigger_state": {
      "type": "string",
      "required": false,
      "description": "State value for state triggers"
    },
    "trigger_time": {
      "type": "string",
      "format": "HH:MM:SS",
      "required": false,
      "description": "Time for time-based triggers"
    },
    "delay_seconds": {
      "type": "integer",
      "min": 0,
      "max": 3600,
      "required": true,
      "description": "Delay in seconds before action"
    },
    "action_service": {
      "type": "string",
      "required": true,
      "description": "Service to call after delay"
    },
    "target_entity": {
      "type": "string",
      "required": false,
      "description": "Target entity ID"
    },
    "target_area": {
      "type": "string",
      "required": false,
      "description": "Target area ID"
    },
    "action_data": {
      "type": "object",
      "required": false,
      "description": "Action data"
    }
  },
  "safety_class": "low",
  "forbidden_targets": [],
  "compilation_mapping": {
    "trigger": {
      "platform": "{{trigger_type}}",
      "entity_id": "{{trigger_entity}}",
      "at": "{{trigger_time}}",
      "to": "{{trigger_state}}"
    },
    "condition": null,
    "action": [
      {
        "delay": "00:00:{{delay_seconds}}"
      },
      {
        "service": "{{action_service}}",
        "target": {
          "entity_id": "{{target_entity}}",
          "area_id": "{{target_area}}"
        },
        "data": "{{action_data}}"
      }
    ],
    "alias_template": "Delayed: {{action_service}}",
    "description_template": "Execute {{action_service}} after {{delay_seconds}} seconds delay"
  },
  "examples": [
    {
      "trigger_type": "state",
      "trigger_entity": "binary_sensor.motion",
      "trigger_state": "off",
      "delay_seconds": 300,
      "action_service": "light.turn_off",
      "target_area": "office"
    }
  ]
}
