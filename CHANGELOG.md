# Changelog

## [Unreleased] - 2026-02-08

### Added

- **feat(docker): add missing services to compose; align docs and Cursor refs** (d19b1fb) - wtthornton
- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton

### Fixed

- **fix(e2e): comprehensive Playwright test quality pass â€” fix 43+ issues across all specs** (15eb6be) - wtthornton
- **unit test fixes for conftest, ask_ai test button, and context7** (48a52f5) - wtthornton
- **add is_blueprint column migration for automation-miner** (45fa46e) - wtthornton
- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton


### Added

- **feat(docker): add missing services to compose; align docs and Cursor refs** (d19b1fb) - wtthornton
- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton

### Fixed

- **unit test fixes for conftest, ask_ai test button, and context7** (48a52f5) - wtthornton
- **add is_blueprint column migration for automation-miner** (45fa46e) - wtthornton
- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton


### Added

- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton
- **Implement entity capabilities enrichment and device card entity display** (571dbb7) - wtthornton

### Fixed

- **add is_blueprint column migration for automation-miner** (45fa46e) - wtthornton
- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton


### Added

- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton
- **Implement entity capabilities enrichment and device card entity display** (571dbb7) - wtthornton
- **Add Streamlit observability dashboard with OpenTelemetry integration** (6bdb15f) - wtthornton

### Fixed

- **add is_blueprint column migration for automation-miner** (45fa46e) - wtthornton
- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton


### Added

- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton
- **Implement entity capabilities enrichment and device card entity display** (571dbb7) - wtthornton
- **Add Streamlit observability dashboard with OpenTelemetry integration** (6bdb15f) - wtthornton

### Fixed

- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton
- **Fix Docker deployment issues: FastAPI dependency injection and TypeScript errors** (88c7ac5) - wtthornton


### Added

- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton
- **Implement entity capabilities enrichment and device card entity display** (571dbb7) - wtthornton
- **Add Streamlit observability dashboard with OpenTelemetry integration** (6bdb15f) - wtthornton

### Fixed

- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton
- **Fix Docker deployment issues: FastAPI dependency injection and TypeScript errors** (88c7ac5) - wtthornton


### Added

- **Add service tier ranking and clean up documentation** (f7a887a) - wtthornton
- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton
- **Implement entity capabilities enrichment and device card entity display** (571dbb7) - wtthornton
- **Add Streamlit observability dashboard with OpenTelemetry integration** (6bdb15f) - wtthornton

### Changed

- **Improve code quality across 29 files in 25 services** (4bfb575) - wtthornton

### Fixed

- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton
- **Fix Docker deployment issues: FastAPI dependency injection and TypeScript errors** (88c7ac5) - wtthornton


### Added

- **Add diagnostics, backups, and migration artifacts to .gitignore** (263d12c) - wtthornton
- **Add --no-prompt flag for automated Phase D execution** (cfa9233) - wtthornton
- **Add --skip-tests flag to MQTT migration script** (b8da908) - wtthornton
- **Add --skip-tests flag to all migration scripts** (612fc8e) - wtthornton
- **Add Phase 1 automated batch rebuild system for 40 services** (ec9e337) - wtthornton
- **Phase 2 library upgrades - standard library updates** (9f8eeba) - wtthornton
- **Phase 1 library upgrades - critical compatibility fixes** (b17796f) - wtthornton
- **add Home Assistant automation linter service** (9212bed) - wtthornton
- **Implement entity capabilities enrichment and device card entity display** (571dbb7) - wtthornton
- **Add Streamlit observability dashboard with OpenTelemetry integration** (6bdb15f) - wtthornton

### Changed

- **Improve code quality across 29 files in 25 services** (4bfb575) - wtthornton

### Fixed

- **Fix blueprint-suggestion-service: create tests directory and migrate** (59827f0) - wtthornton
- **Fix data-retention InfluxDB write_api usage** (43b4664) - wtthornton
- **Fix energy-forecasting InfluxDB API to use new influxdb3-python** (e969324) - wtthornton
- **Fix orchestrator script references after rename** (2d89316) - wtthornton
- **Resolve ai-automation-ui TypeScript compilation errors** (3bd93bf) - wtthornton
- **Resolve api-automation-edge queue module naming conflict** (c93b149) - wtthornton
- **Fix Docker deployment issues: FastAPI dependency injection and TypeScript errors** (88c7ac5) - wtthornton
- **Fix type union syntax - use Optional/Union instead of | syntax for Python 3.12 compatibility** (2585bb2) - wtthornton

All notable changes to HomeIQ will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

---

## [2.0.0] - 2026-02-06

### Major Release: Phase 2 Library Upgrades Complete

This release completes the Phase 2 library upgrade initiative, migrating all 31 Python services to modern library versions with breaking changes handled systematically.

### Added

- **TECH_STACK.md** - Comprehensive technology stack documentation
- **CHANGELOG.md** - Project changelog (this file)
- Phase 2 migration scripts for automated library upgrades
- Docker memory optimization across all 41 containers

### Changed

#### Library Upgrades (Breaking Changes)

| Library | Old | New | Migration |
|---------|-----|-----|-----------|
| pytest-asyncio | 0.x | 1.3.0 | Added `loop_scope="function"` parameter |
| tenacity | 8.x | 9.1.2 | Updated to `retry_if_exception_cause_type()` |
| asyncio-mqtt | 0.x | aiomqtt 2.4.0 | Package rename and API updates |
| influxdb-client | 1.x | influxdb3-python 0.17.0 | New `InfluxDBClient3` class, SQL queries |
| python-dotenv | 1.0.x | 1.2.1 | Minor API updates |

#### Service Updates

- **ai-automation-service-new**: Fixed Pydantic 2.12 compatibility with FastAPI dependency injection
  - Changed from `Annotated[Type, Depends()]` to `Type = Depends()` pattern
  - Updated `deployment_router.py` and `suggestion_router.py`

- **health-dashboard**: Fixed nginx proxy configuration for API authentication
  - Added `Authorization` header forwarding to `/api/v1/` location block

- **energy-forecasting**: Full InfluxDB 3.0 API migration
  - Updated `energy_loader.py` to use `InfluxDBClient3`
  - Changed from Flux queries to SQL queries

- **data-retention**: Updated InfluxDB write API
  - Changed from `write_api().write()` to `client.write()`

### Fixed

- **"Failed to load deployed automations: Unprocessable Entity"** error in AI Automation UI
  - Root cause: Pydantic 2.12 TypeAdapter incorrectly treating `Annotated` dependencies as Query parameters
  - Solution: Use traditional `= Depends()` style for FastAPI dependency injection

- **Admin Dashboard showing "unknown" status**
  - Root cause: nginx proxy not forwarding Authorization header for `/api/v1/` endpoints
  - Solution: Added `proxy_set_header Authorization` and `proxy_pass_header Authorization`

### Optimized

- **Docker Memory Limits** - Reduced overall memory footprint by ~5-6 GB
  | Category | Before | After | Savings |
  |----------|--------|-------|---------|
  | data-api | 1G | 256M | 75% |
  | openvino-service | 1.5G | 768M | 49% |
  | ner-service | 1G | 512M | 50% |
  | Standard services | 512M | 128M | 75% |
  | UI services | 256M | 64M | 75% |

### Migration Statistics

- **31/31** Python services migrated (100% success rate)
- **41/41** Docker images rebuilt
- **0** regression issues

---

## [1.9.0] - 2026-02-05

### Phase 2 Breaking Changes Migration

### Changed

- Initiated Phase 2 library upgrade automation
- Created migration scripts for:
  - `pytest-asyncio` 1.3.0 migration
  - `tenacity` 9.1.2 migration
  - `aiomqtt` 2.4.0 migration (from asyncio-mqtt)
  - `influxdb3-python` 0.17.0 migration

### Added

- Phase 2 planning documentation:
  - `phase2-implementation-plan.md`
  - `phase2-pytest-asyncio-migration-guide.md`
  - `phase2-tenacity-migration-guide.md`
  - `phase2-mqtt-migration-guide.md`
  - `phase2-influxdb-migration-guide.md`

---

## [1.8.0] - 2026-02-04

### Phase 1 Critical Compatibility Fixes

### Changed

- **SQLAlchemy**: 2.0.45 -> 2.0.46 (bug fixes, performance)
- **aiosqlite**: 0.21.0 -> 0.22.1 (async improvements, Python 3.13 support)

### Fixed

- Phase 0 infrastructure verification complete
- All 38/40 services rebuilt (95% success rate)

---

## [1.7.0] - 2026-01-xx

### Initial Phase 1 Library Upgrades

### Changed

- Updated core libraries to latest stable versions
- Established `requirements-base.txt` shared dependency file
- Implemented version range strategy for patch updates

### Added

- Library upgrade planning documentation
- Automated batch rebuild scripts
- Service health validation framework

---

## [1.6.0] - 2025-12-xx

### Automation Linter

### Added

- YAML automation linting service with 15+ quality rules
- Automation validation API endpoints
- Auto-fix capabilities for common issues

### Documentation

- `docs/automation-linter.md` - Feature documentation
- `docs/automation-linter-rules.md` - Complete rules catalog

---

## [1.5.0] - 2025-11-xx

### AI Automation UI

### Added

- Natural language automation creation interface
- Real-time suggestion generation
- Pattern detection visualization

### Changed

- Migrated from legacy ai-automation-service to ai-automation-service-new
- Improved deployment workflow

---

## [1.4.0] - 2025-10-xx

### Health Dashboard Enhancements

### Added

- System Status Hero component
- RAG Status monitoring
- Core System Cards (Ingestion, Storage)
- Performance sparklines
- Service dependency visualization

### Changed

- Redesigned Overview Tab for "5-second health check"
- Added data freshness indicators

---

## [1.3.0] - 2025-09-xx

### Data API Consolidation (Epic 13)

### Changed

- Consolidated data endpoints into data-api service
- Separated admin-api (system monitoring) from data-api (feature data)
- Implemented nginx proxy routing for API segmentation

---

## [1.2.0] - 2025-08-xx

### Event Flow Architecture (Epic 31)

### Changed

- Redesigned event ingestion pipeline
- Direct writes from websocket-ingestion to InfluxDB
- Inline normalization in websocket-ingestion

### Added

- Event flow architecture documentation
- InfluxDB schema documentation

---

## [1.1.0] - 2025-07-xx

### Sports Data Integration

### Added

- Sports API service (NFL, NHL, MLB support)
- Live game tracking
- Home Assistant game context integration

---

## [1.0.0] - 2025-06-xx

### Initial Release

### Added

- Core microservices architecture (30+ services)
- Home Assistant WebSocket integration
- AI-powered automation suggestions
- Device intelligence service
- Weather, energy pricing, air quality enrichment
- Health Dashboard (React)
- AI Automation UI (React)
- InfluxDB time-series storage
- SQLite metadata storage
- OpenTelemetry observability

---

## Version Naming

- **Major (X.0.0)**: Breaking changes, major features
- **Minor (0.X.0)**: New features, non-breaking changes
- **Patch (0.0.X)**: Bug fixes, documentation updates

---

## Links

- [README](README.md)
- [Tech Stack](TECH_STACK.md)
- [Contributing Guide](CONTRIBUTING.md)
- [Documentation](docs/)
