# Step 1: Enhanced Prompt - Proactive Agent Service UI Integration

## Original Request
"Integrate proactive-agent-service into the ai-automation-ui frontend to make context-aware suggestions visible to users"

## Enhanced Specification

### Problem Statement
The proactive-agent-service (Port 8031) generates valuable context-aware automation suggestions by analyzing:
- Weather conditions and forecasts
- Sports events and schedules  
- Energy pricing and carbon intensity
- Historical usage patterns

However, these suggestions are currently **orphaned** - they run at 3 AM daily but:
- No UI displays them
- Users cannot see, approve, or reject them
- The workflow is incomplete (no feedback loop)

### Solution Overview
Integrate proactive-agent-service into the existing ai-automation-ui frontend by:
1. Adding nginx proxy route for API access
2. Creating a new "Proactive" tab/section in the UI
3. Building React components to display proactive suggestions
4. Enabling user actions (approve, reject, view details)

### Requirements

#### Functional Requirements
| ID | Requirement | Priority |
|----|-------------|----------|
| FR-1 | Display proactive suggestions in UI | Critical |
| FR-2 | Filter suggestions by context type (weather, sports, energy) | High |
| FR-3 | Filter suggestions by status (pending, sent, approved, rejected) | High |
| FR-4 | Update suggestion status (approve/reject) | Critical |
| FR-5 | View suggestion details with context metadata | High |
| FR-6 | Manual trigger for suggestion generation | Medium |
| FR-7 | Display suggestion statistics | Medium |

#### Non-Functional Requirements
| ID | Requirement | Target |
|----|-------------|--------|
| NFR-1 | Page load time | < 2 seconds |
| NFR-2 | API response time | < 500ms |
| NFR-3 | Consistent styling with existing UI | 100% match |
| NFR-4 | Mobile responsive | Yes |
| NFR-5 | Error handling | Graceful degradation |

### Technical Context

#### Existing Architecture
- **Frontend**: ai-automation-ui (React + TypeScript + Vite)
- **Backend**: proactive-agent-service (FastAPI, Port 8031)
- **Proxy**: nginx in ai-automation-ui container
- **Database**: SQLite (proactive-agent-service has own DB)

#### API Endpoints Available (proactive-agent-service)
```
GET  /api/v1/suggestions           - List suggestions with filters
GET  /api/v1/suggestions/{id}      - Get suggestion by ID
PATCH /api/v1/suggestions/{id}     - Update suggestion status
DELETE /api/v1/suggestions/{id}    - Delete suggestion
GET  /api/v1/suggestions/stats/summary - Get statistics
POST /api/v1/suggestions/trigger   - Manual trigger
GET  /health                       - Health check
```

#### Suggestion Data Model
```typescript
interface ProactiveSuggestion {
  id: string;
  prompt: string;
  context_type: 'weather' | 'sports' | 'energy' | 'historical';
  status: 'pending' | 'sent' | 'approved' | 'rejected';
  quality_score: number;
  context_metadata: Record<string, any>;
  prompt_metadata: Record<string, any>;
  agent_response?: Record<string, any>;
  created_at: string;
  sent_at?: string;
  updated_at: string;
}
```

### Quality Standards
- Code quality score: ≥ 70
- Security score: ≥ 7.0/10
- Test coverage: ≥ 80%
- Follow existing UI patterns and styling
- TypeScript strict mode compliance

### Scope Boundaries

#### In Scope
- Nginx route configuration
- React page component for proactive suggestions
- API client for proactive-agent-service
- Navigation integration
- Basic CRUD operations for suggestions

#### Out of Scope
- Changes to proactive-agent-service backend
- Database schema changes
- HA AI Agent integration enhancements
- Combining with ai-automation-service database

### Success Criteria
1. Users can view proactive suggestions in UI
2. Users can filter by context type and status
3. Users can approve/reject suggestions
4. Statistics are displayed
5. Manual trigger works
6. UI matches existing design patterns

---
*Generated by Simple Mode Build Workflow*
*Timestamp: 2026-01-07*
