# Story 31.1: Weather API Service Foundation

## Status

Complete

## Story

**As a** DevOps engineer,
**I want** a simple weather API service with health checks and Docker deployment,
**so that** the weather service follows the same pattern as carbon-intensity and air-quality services.

## Acceptance Criteria

1. Single-file FastAPI service created (`src/main.py` and `src/health_check.py` only)
2. Service runs on Port 8009 with CORS for dashboard
3. Health check endpoint `/health` returns service status
4. Docker deployment configured (Alpine-based)
5. Service registered in docker-compose.yml
6. Environment variable configuration
7. Service starts successfully in Docker
8. Basic tests pass

## Tasks / Subtasks

- [x] Task 1: Create Service Structure
  - [x] Create `services/weather-api/src/` directory
  - [x] Create `services/weather-api/tests/` directory
  - [x] Create requirements.txt

- [x] Task 2: Implement FastAPI Service (Single File)
  - [x] Create `src/main.py` with WeatherService class
  - [x] Add CORS middleware
  - [x] Add `/` and `/health` endpoints
  - [x] Add startup/shutdown handlers

- [x] Task 3: Docker Configuration
  - [x] Create `Dockerfile` (Alpine multi-stage)
  - [x] Create `Dockerfile.dev` for development
  - [x] Create `.dockerignore`
  - [x] Update `docker-compose.yml` with weather-api service

- [x] Task 4: Environment & Documentation
  - [x] Create `infrastructure/env.weather.template`
  - [x] Create service README.md
  - [x] Basic tests created

## Dev Notes

**SIMPLE PATTERN - Follow carbon-intensity-service:**
- ONE WeatherService class in main.py
- NO separate modules (cache, circuit breaker, etc.)
- Inline simple caching (dict with timestamp)
- All logic in ~200 lines

**Files Created:**
- `src/main.py` (main service)
- `src/health_check.py` (health check only)
- Tests, Docker files, env template

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Initial creation | BMad Master |
| 2025-10-19 | 2.0 | Simplified - removed over-engineering | BMad Master |

## Dev Agent Record

### Completion Notes

âœ… Story 31.1 COMPLETE - Simple foundation deployed
- 12 files created
- Single-file pattern (like carbon-intensity)
- Docker deployment configured
- Health checks working
