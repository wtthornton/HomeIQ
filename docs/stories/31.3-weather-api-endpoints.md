# Story 31.3: Weather API Endpoints & Query Support

## Status

Complete

## Story

**As a** dashboard developer,
**I want** simple REST endpoints to get current weather,
**so that** the dashboard can display weather data.

## Acceptance Criteria

1. GET /current-weather returns cached weather (<100ms)
2. GET /cache/stats returns hit/miss statistics
3. Pydantic response model for type safety
4. Proper error handling (503 when unavailable)
5. OpenAPI docs auto-generated

## Tasks / Subtasks

- [x] Task 1: Current Weather Endpoint
  - [x] Add GET /current-weather route
  - [x] Return WeatherResponse model
  - [x] Call weather_service.get_current_weather()
  - [x] Handle 503 when no data

- [x] Task 2: Cache Stats Endpoint
  - [x] Add GET /cache/stats route
  - [x] Return hits, misses, hit_rate
  - [x] Simple dict response (no Pydantic needed)

- [x] Task 3: Response Model
  - [x] Define WeatherResponse (Pydantic)
  - [x] Basic fields only (temp, humidity, condition)
  - [x] Auto-generates OpenAPI docs

## Dev Notes

**SIMPLE ENDPOINTS:**
```python
@app.get("/current-weather", response_model=WeatherResponse)
async def get_current_weather():
    weather = await weather_service.get_current_weather()
    if not weather:
        raise HTTPException(status_code=503, detail="No data")
    return WeatherResponse(**weather)

@app.get("/cache/stats")
async def cache_stats():
    return {
        "hits": weather_service.cache_hits,
        "misses": weather_service.cache_misses,
        "hit_rate": calculate_hit_rate()
    }
```

**NO forecast, historical, or complex queries** - Keep it simple like air-quality-service

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Initial creation | BMad Master |
| 2025-10-19 | 2.0 | Simplified - basic endpoints only | BMad Master |

## Dev Agent Record

### Completion Notes

âœ… Story 31.3 COMPLETE - Basic endpoints in main.py
- GET /current-weather
- GET /cache/stats
- WeatherResponse model
- Total ~30 lines added
