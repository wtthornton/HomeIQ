# Story 31.5: Dashboard & Query Integration

## Status

Draft

## Story

**As a** dashboard user,
**I want** a simple weather widget showing current conditions,
**so that** I can see weather data in the dashboard.

## Acceptance Criteria

1. Simple weather widget on Data Sources tab
2. Fetch from weather-api:8009/current-weather
3. Show temperature, humidity, condition
4. Auto-refresh every 15 minutes
5. Handle errors gracefully (show "unavailable")

## Tasks / Subtasks

- [ ] Task 1: Add Weather API Call
  - [ ] Add fetch to DataSourcesTab.tsx
  - [ ] Simple useEffect with 15-min interval
  - [ ] Handle loading/error states

- [ ] Task 2: Display Weather
  - [ ] Add weather card to Data Sources tab
  - [ ] Show temp, humidity, condition
  - [ ] Style with existing TailwindCSS classes

- [ ] Task 3: Error Handling
  - [ ] Show "Weather unavailable" if fetch fails
  - [ ] Add retry button
  - [ ] Log errors to console

## Dev Notes

**SIMPLE WIDGET (~50 lines):**
```tsx
function DataSourcesTab() {
  const [weather, setWeather] = useState(null);
  
  useEffect(() => {
    const fetchWeather = async () => {
      try {
        const res = await fetch('http://localhost:8009/current-weather');
        if (res.ok) setWeather(await res.json());
      } catch (e) {
        console.error('Weather fetch failed:', e);
      }
    };
    
    fetchWeather();
    const interval = setInterval(fetchWeather, 15 * 60 * 1000);
    return () => clearInterval(interval);
  }, []);
  
  return (
    <div className="weather-card">
      {weather ? (
        <div>{weather.temperature}Â°C - {weather.condition}</div>
      ) : (
        <div>Weather unavailable</div>
      )}
    </div>
  );
}
```

**NO separate weatherApi.ts module** - Just inline fetch

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Initial creation | BMad Master |
| 2025-10-19 | 2.0 | Simplified - inline everything | BMad Master |
