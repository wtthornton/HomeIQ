# Calendar Service Configuration
# Service for Home Assistant calendar integration and occupancy prediction

# ==============================================================================
# Home Assistant Connection
# ==============================================================================

# Home Assistant instance URL (local network or Nabu Casa)
HOME_ASSISTANT_URL=http://homeassistant.local:8123

# Long-lived access token from Home Assistant
# Create in HA: Profile → Security → Long-Lived Access Tokens
HOME_ASSISTANT_TOKEN=your_long_lived_access_token_here

# ==============================================================================
# Calendar Configuration
# ==============================================================================

# Comma-separated list of calendar entity IDs to monitor
# Examples:
#   - Single calendar: calendar.primary
#   - Multiple calendars: calendar.primary,calendar.work,calendar.personal
#   - With or without 'calendar.' prefix: primary,work or calendar.primary,calendar.work
CALENDAR_ENTITIES=calendar.primary

# Fetch interval in seconds (how often to check calendars)
# Default: 900 (15 minutes)
# Recommended: 600-1800 (10-30 minutes)
CALENDAR_FETCH_INTERVAL=900

# ==============================================================================
# InfluxDB Configuration
# ==============================================================================

# InfluxDB connection URL
INFLUXDB_URL=http://influxdb:8086

# InfluxDB authentication token
INFLUXDB_TOKEN=your_influxdb_token

# InfluxDB organization
INFLUXDB_ORG=home_assistant

# InfluxDB bucket for calendar data
INFLUXDB_BUCKET=events

# ==============================================================================
# Service Configuration
# ==============================================================================

# Service port
SERVICE_PORT=8013

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# ==============================================================================
# Usage Notes
# ==============================================================================
#
# 1. Setup Home Assistant Calendar Integration:
#    - Go to Settings → Devices & Services → Add Integration
#    - Choose calendar provider (Google, CalDAV, Office 365, etc.)
#    - Complete authentication
#    - Note the calendar entity ID (e.g., calendar.primary)
#
# 2. Create Long-Lived Access Token:
#    - Click your profile (bottom left)
#    - Scroll to "Long-Lived Access Tokens"
#    - Click "Create Token"
#    - Name: "Calendar Service"
#    - Copy and paste token above
#
# 3. Find Calendar Entity IDs:
#    # Using HA API:
#    curl -H "Authorization: Bearer YOUR_TOKEN" \
#         http://homeassistant.local:8123/api/states | \
#         jq '.[] | select(.entity_id | startswith("calendar."))'
#
#    # Or in Home Assistant UI:
#    Developer Tools → States → Filter by "calendar"
#
# 4. Multiple Calendars:
#    - Supports monitoring multiple calendars simultaneously
#    - Combines events from all calendars for occupancy prediction
#    - Format: CALENDAR_ENTITIES=calendar.google,calendar.icloud,calendar.work
#
# 5. Occupancy Detection:
#    - Automatically detects WFH (Work From Home) patterns
#    - Looks for: "WFH", "Work From Home", "Home Office" in event titles
#    - Detects home location: "Home", "House", "Residence" in location
#    - Away detection: "Office", "Work", "Travel", "Trip" in titles/locations
#
# 6. InfluxDB Data:
#    - Measurement: occupancy_prediction
#    - Tags: source=calendar, user=primary
#    - Fields: currently_home, wfh_today, confidence, hours_until_arrival
#
# ==============================================================================

