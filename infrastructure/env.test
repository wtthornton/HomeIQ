# Epic 40: Test Environment Configuration
# Use this file for test deployment: docker-compose --profile test up -d
# Copy this to .env when deploying test environment

# =============================================================================
# Deployment Mode Configuration (Epic 40)
# =============================================================================
DEPLOYMENT_MODE=test

# =============================================================================
# InfluxDB Test Configuration (Separate Bucket in Shared Instance)
# =============================================================================
INFLUXDB_URL=http://influxdb:8086
INFLUXDB_USERNAME=admin
INFLUXDB_PASSWORD=admin123
INFLUXDB_ORG=homeiq-test
INFLUXDB_BUCKET=home_assistant_events_test
INFLUXDB_TOKEN=homeiq-test-token

# =============================================================================
# Home Assistant Test Container Configuration
# =============================================================================
HA_TEST_URL=http://home-assistant-test:8123
HA_TEST_WS_URL=ws://home-assistant-test:8123/api/websocket
HA_TEST_TOKEN=${HA_TEST_TOKEN:-}
HA_HTTP_URL=http://home-assistant-test:8123
HA_WS_URL=ws://home-assistant-test:8123/api/websocket
HA_TOKEN=${HA_TEST_TOKEN:-}

# =============================================================================
# SQLite Test Database Configuration
# =============================================================================
DATABASE_URL=sqlite+aiosqlite:///./data/test/metadata.db

# =============================================================================
# External API Services - DISABLED in Test Mode (Epic 40)
# =============================================================================
# These services are excluded via Docker Compose profiles to save resources
# and prevent API quota consumption during testing
ENABLE_WEATHER_API=false
ENABLE_CARBON_INTENSITY=false
ENABLE_ELECTRICITY_PRICING=false
ENABLE_AIR_QUALITY=false
ENABLE_CALENDAR=false
ENABLE_SMART_METER=false
ENABLE_SPORTS_DATA=false

# =============================================================================
# AI Services - ENABLED in Test Mode (Epic 40)
# =============================================================================
ENABLE_AI_AUTOMATION=true
ENABLE_OPENAI_SERVICE=true
ENABLE_DEVICE_INTELLIGENCE=true

# =============================================================================
# Data Generation Services - ENABLED in Test Mode (Epic 40)
# =============================================================================
ENABLE_SYNTHETIC_DATA_GENERATION=true
ENABLE_MOCK_DATA_CREATION=true

# =============================================================================
# Logging Configuration
# =============================================================================
LOG_LEVEL=INFO
LOG_FILE_PATH=/app/logs
LOG_FORMAT=json
LOG_OUTPUT=both

# =============================================================================
# Service Ports (Test Environment)
# =============================================================================
ADMIN_API_PORT=8003
WEBSOCKET_INGESTION_PORT=8002  # Test uses port 8002
DATA_API_PORT=8006
HEALTH_DASHBOARD_PORT=3000
INFLUXDB_PORT=8086

# =============================================================================
# Authentication Configuration
# =============================================================================
JWT_SECRET_KEY=test-jwt-secret-key
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
ADMIN_PASSWORD=testadminpass
API_KEY=hs_P3rU9kQ2xZp6vL1fYc7bN4sTqD8mA0wR

# =============================================================================
# Timezone Configuration
# =============================================================================
TZ=America/Los_Angeles

# =============================================================================
# Data Retention Configuration (Test)
# =============================================================================
CLEANUP_INTERVAL_HOURS=24
MONITORING_INTERVAL_MINUTES=5
COMPRESSION_INTERVAL_HOURS=24
BACKUP_INTERVAL_HOURS=24
BACKUP_DIR=/backups

# =============================================================================
# WebSocket Retry Configuration
# =============================================================================
WEBSOCKET_MAX_RETRIES=-1
WEBSOCKET_MAX_RETRY_DELAY=300

# =============================================================================
# Notes
# =============================================================================
# - Test and Production deployments are MUTUALLY EXCLUSIVE on 8GB NUC
# - Test deployment uses separate InfluxDB bucket for isolation
# - External API services are disabled to save resources and prevent quota usage
# - AI services remain enabled for testing automation features
# - Data generation services enabled for synthetic data testing

