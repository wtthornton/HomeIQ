id: 'office_wled_sync_with_living_room_by_time'
alias: Office WLED â€“ Sync Brightness with Living Room by Time
description: "Keep the Office WLED brightness aligned with living room activity and time of day."
mode: restart
trigger:
  - platform: state
    entity_id: light.living_room_2
variables:
  office_brightness: "{{ state_attr('light.wled', 'brightness') | int(0) }}"
  living_brightness: "{{ state_attr('light.living_room_2', 'brightness') | int(0) }}"
  office_day_target: 179
  office_night_target: 77
condition: []
action:
  - delay: "00:00:02"
  - choose:
      - conditions:
          - condition: time
            after: "06:00:00"
            before: "18:00:00"
          - condition: template
            value_template: "{{ states('light.wled') == 'on' and office_brightness > 0 and office_brightness < 128 }}"
          - condition: template
            value_template: "{{ office_brightness != office_day_target }}"
        sequence:
          - service: light.turn_on
            target:
              entity_id: light.wled
            data:
              brightness: 179
      - conditions:
          - condition: or
            conditions:
              - condition: time
                after: "18:00:00"
                before: "23:59:59"
              - condition: time
                after: "00:00:00"
                before: "06:00:00"
          - condition: template
            value_template: "{{ states('light.living_room_2') == 'on' and living_brightness > 153 }}"
          - condition: template
            value_template: "{{ states('light.wled') == 'on' }}"
          - condition: template
            value_template: "{{ office_brightness != office_night_target }}"
        sequence:
          - service: light.turn_on
            target:
              entity_id: light.wled
            data:
              brightness: 77
  - delay: "00:00:02"