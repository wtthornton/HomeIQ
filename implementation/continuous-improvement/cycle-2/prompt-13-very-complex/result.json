{
  "prompt_id": "prompt-13-very-complex",
  "prompt_name": "Complex State Management",
  "prompt_text": "When the Office WLED is turned on, save its current state. Then turn on all living room lights to 80%. After 10 minutes, restore the Office WLED to its saved state and turn off all living room lights",
  "complexity": "Very Complex",
  "query_id": "query-94fa797a",
  "suggestion_id": "ask-ai-988998ea",
  "automation_id": "automation.office_wled_temp_living_room_lighting_1764011811_658b5b5b",
  "automation_yaml": "id: 'office_wled_temp_living_room_lighting'\nalias: Office WLED \u2192 Temporary Living Room Lighting\ndescription: \"When Office WLED turns on, brighten Living Room to 80%, then restore WLED and turn Living Room off after 10 minutes.\"\nmode: restart\ntrigger:\n  - platform: state\n    entity_id: light.wled\n    to: 'on'\nconditions: []\naction:\n  # Step 1 \u2013 Snapshot Office WLED state before changes\n  - service: scene.create\n    data:\n      scene_id: office_wled_before_temp_living_room\n      snapshot_entities:\n        - light.wled\n\n  # Step 2 \u2013 Turn on Living Room light to ~80% brightness if supported\n  - choose:\n      - conditions:\n          - condition: template\n            value_template: \"{{ state_attr('light.living_room_2','supported_features')|int(default=0) % 2 == 0 }}\"\n        sequence:\n          - service: light.turn_on\n            target:\n              entity_id: light.living_room_2\n            data:\n              brightness_pct: 80\n    default:\n      - service: light.turn_on\n        target:\n          entity_id: light.living_room_2\n\n  # Step 3 \u2013 Wait 10 minutes\n  - delay: '00:10:00'\n\n  # Step 4 \u2013 Restore Office WLED to saved state\n  - service: scene.turn_on\n    target:\n      entity_id: scene.office_wled_before_temp_living_room\n\n  # Step 5 \u2013 Turn off Living Room light\n  - service: light.turn_off\n    target:\n      entity_id: light.living_room_2",
  "clarification_rounds": 1,
  "clarification_log": [
    {
      "round": 1,
      "questions": [
        {
          "id": "q1",
          "category": "device",
          "question_text": "Which device did you mean? Device 'lights' matches devices in wrong location. You mentioned: living, office, living_room",
          "question_type": "text",
          "options": null,
          "priority": 1,
          "related_entities": [
            "c0070ae3ca3271e5c18c37fc1beaf0e8"
          ],
          "cached_answer": null,
          "cached_entities": null,
          "cached_similarity": null
        },
        {
          "id": "q2",
          "category": "action",
          "question_text": "Could you clarify: Action 'turn' is vague - missing details: dim, brighten",
          "question_type": "text",
          "options": null,
          "priority": 2,
          "related_entities": null,
          "cached_answer": null,
          "cached_entities": null,
          "cached_similarity": null
        }
      ],
      "answers": [
        {
          "question_id": "q1",
          "answer_text": "Office Wled",
          "selected_entities": null
        },
        {
          "question_id": "q2",
          "answer_text": "Yes",
          "selected_entities": null
        }
      ],
      "timestamp": "2025-11-24T11:16:13.673280"
    }
  ],
  "automation_score": 85.0,
  "yaml_score": 100.0,
  "total_score": 91.5,
  "error": null,
  "success": true,
  "timestamp": "2025-11-24T11:16:11.475267"
}