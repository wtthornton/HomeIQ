id: 'office_wled_random_effect_15min'
alias: Office WLED â€“ Random effect every 15 minutes (with state restore)
description: "Every 15 minutes play a 15s random WLED effect on Office, then restore original Office state."
mode: single
trigger:
  - platform: time_pattern
    minutes: "/15"
conditions: []
action:
  - service: scene.create
    data:
      scene_id: office_wled_before_random_effect
      snapshot_entities:
        - light.wled
  - variables:
      rand_r: "{{ range(0, 256) | random }}"
      rand_g: "{{ range(0, 256) | random }}"
      rand_b: "{{ range(0, 256) | random }}"
      rand_effect: >-
        {{ [
          'Solid', 'Blink', 'Breathe', 'Android', 'Aurora', 'Bee', 'Blends',
          'Blink Rainbow', 'Bouncing Balls', 'Bpm', 'Candle', 'Candle Multi',
          'Chase', 'Chase 2', 'Chase 3', 'Chase Rainbow', 'Chunchun',
          'Colorloop', 'Colorful', 'Colorwaves', 'Dancing Shadows', 'DNA',
          'Dissolve', 'Dissolve Rnd', 'Drip', 'Drip Rainbow', 'Dynamic',
          'Fairy', 'Fill Noise', 'Fire 2012', 'Fire Flicker', 'Fireworks 1D',
          'Fireworks Starburst', 'Flow', 'Funky Plank', 'Glitter', 'Gradient',
          'Gravcenter', 'Gravcentric', 'Heartbeat', 'ICU', 'Juggle', 'Lake',
          'Lighthouse', 'Lightning', 'Matrix', 'Meteor', 'Meteor Smooth',
          'Noise 1', 'Noise 2', 'Noise 3', 'Noise 4', 'Oscillate', 'Pianola',
          'Pride 2015', 'Rain', 'Railway', 'Rainbow', 'Rainbow Runner',
          'Ripple', 'Running', 'Running 2', 'Scanner', 'Scanner Dual',
          'Scan', 'Sinelon', 'Sinelon Dual', 'Sinelon Rainbow', 'Slope',
          'Sparkle', 'Sparkle Dark', 'Spots', 'Spots Fade', 'Stream',
          'Strobe', 'Strobe Mega', 'Strobe Rainbow', 'Sunrise',
          'Sweep', 'Sweep Random', 'Theater', 'Theater Rainbow', 'Traffic Light',
          'Tri Chase', 'Tri Fade', 'Tri Wipe', 'Twinkle', 'Twinklecat',
          'Twinklefox', 'Waterfall', 'Wipe', 'Wipe Random'
        ] | random }}
  - service: light.turn_on
    target:
      entity_id: light.wled
    data:
      effect: "{{ rand_effect }}"
      brightness: 255
      rgb_color:
        - "{{ rand_r }}"
        - "{{ rand_g }}"
        - "{{ rand_b }}"
  - delay: "00:00:15"
  - service: scene.turn_on
    target:
      entity_id: scene.office_wled_before_random_effect