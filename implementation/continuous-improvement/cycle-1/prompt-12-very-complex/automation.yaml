id: 'office_wled_random_15s_pulse_full_restore'
alias: Office WLED - Random 15s Pulse with Full Restore
description: "Every 15 minutes, play a random WLED effect at 100% brightness for 15 seconds, then restore previous Office state."
mode: single
trigger:
  - platform: time_pattern
    minutes: "/15"
conditions: []
action:
  - service: scene.create
    data:
      scene_id: office_wled_pre_pulse_state
      snapshot_entities:
        - light.wled
  - service: light.turn_on
    target:
      entity_id: light.wled
    data:
      brightness: 255
      effect: random
      rgb_color:
        - "{{ range(0, 256) | random }}"
        - "{{ range(0, 256) | random }}"
        - "{{ range(0, 256) | random }}"
  - delay: "00:00:15"
  - service: scene.turn_on
    target:
      entity_id: scene.office_wled_pre_pulse_state