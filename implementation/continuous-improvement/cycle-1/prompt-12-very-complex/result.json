{
  "prompt_id": "prompt-12-very-complex",
  "prompt_name": "State Restoration with Conditions",
  "prompt_text": "Every 15 mins choose a random effect on the Office WLED device. Play the effect for 15 secs. Choose random effect, random colors and brightness to 100%. At the end of the 15 sec the WLED light needs to return to exactly what it was before it started.",
  "complexity": "Very Complex",
  "query_id": "query-e67ada5d",
  "suggestion_id": "ask-ai-097a71f3",
  "automation_id": "automation.office_wled_random_burst_15min_1763944875_5f1fe299",
  "automation_yaml": "id: 'office_wled_random_burst_15min'\nalias: Office WLED random effect every 15 minutes\ndescription: \"Every 15 minutes, run a 15-second random WLED effect on Office at 100% brightness, then restore previous state.\"\nmode: single\ntrigger:\n  - platform: time_pattern\n    minutes: '/15'\nconditions: []\naction:\n  - service: scene.create\n    data:\n      scene_id: office_wled_before_random_burst\n      snapshot_entities:\n        - light.wled\n  - variables:\n      effect_source: >-\n        {{ state_attr('light.wled', 'effect_list')\n           if state_attr('light.wled', 'effect_list') is not none\n           else state_attr('light.wled', 'effect_list_summary') }}\n      random_effect: >-\n        {% if effect_source is string %}\n        {{ effect_source.split(', ') | random }}\n        {% else %}\n        {{ effect_source | random }}\n        {% endif %}\n      random_r: \"{{ range(0, 256) | random }}\"\n      random_g: \"{{ range(0, 256) | random }}\"\n      random_b: \"{{ range(0, 256) | random }}\"\n  - service: light.turn_on\n    target:\n      entity_id: light.wled\n    data:\n      brightness: 255\n      rgb_color:\n        - \"{{ random_r }}\"\n        - \"{{ random_g }}\"\n        - \"{{ random_b }}\"\n      effect: \"{{ random_effect }}\"\n  - delay: '00:00:15'\n  - service: scene.turn_on\n    target:\n      entity_id: scene.office_wled_before_random_burst",
  "clarification_rounds": 1,
  "clarification_log": [
    {
      "round": 1,
      "questions": [
        {
          "id": "q1",
          "category": "device",
          "question_text": "Which device did you mean? Device 'light' matches devices in wrong location. You mentioned: office, end of",
          "question_type": "text",
          "options": null,
          "priority": 1,
          "related_entities": [
            "c0070ae3ca3271e5c18c37fc1beaf0e8"
          ],
          "cached_answer": null,
          "cached_entities": null,
          "cached_similarity": null
        },
        {
          "id": "q2",
          "category": "action",
          "question_text": "Could you clarify: Action 'turn' is vague - missing details: dim, brighten",
          "question_type": "text",
          "options": null,
          "priority": 2,
          "related_entities": null,
          "cached_answer": null,
          "cached_entities": null,
          "cached_similarity": null
        }
      ],
      "answers": [
        {
          "question_id": "q1",
          "answer_text": "Office Wled",
          "selected_entities": null
        },
        {
          "question_id": "q2",
          "answer_text": "Yes",
          "selected_entities": null
        }
      ],
      "timestamp": "2025-11-23T16:40:41.030380"
    }
  ],
  "automation_score": 75.0,
  "yaml_score": 100.0,
  "total_score": 86.5,
  "error": null,
  "success": true,
  "timestamp": "2025-11-23T16:40:39.417536"
}