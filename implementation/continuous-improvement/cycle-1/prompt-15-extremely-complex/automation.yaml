id: 'office_wled_living_room_time_sync'
alias: Office WLED - Sync Brightness with Time and Living Room Activity
description: "Keep the Office WLED brightness aligned with living room activity and time of day."
mode: restart
trigger:
  - platform: state
    entity_id: light.wled
action:
  - delay: '00:00:02'
  - variables:
      office_brightness: "{{ state_attr('light.wled', 'brightness') | int(0) }}"
      office_brightness_pct: "{{ (office_brightness / 255 * 100) | round(0) if office_brightness > 0 else 0 }}"
      is_daytime: "{{ now().hour >= 6 and now().hour < 18 }}"
      office_target_day: 70
      office_target_night: 30
  - choose:
      - conditions:
          - condition: template
            value_template: "{{ is_daytime }}"
          - condition: template
            value_template: "{{ office_brightness_pct < 50 }}"
        sequence:
          - condition: template
            value_template: "{{ office_brightness_pct != office_target_day }}"
          - service: light.turn_on
            target:
              entity_id: light.wled
            data:
              brightness_pct: "{{ office_target_day }}"
      - conditions:
          - condition: template
            value_template: "{{ not is_daytime }}"
        sequence:
          - condition: template
            value_template: "{{ office_brightness_pct != office_target_night }}"
          - service: light.turn_on
            target:
              entity_id: light.wled
            data:
              brightness_pct: "{{ office_target_night }}"