id: 'office_wled_living_room_time_based_brightness'
alias: Office WLED â€“ Time-based brightness from Living Room
description: "Keeps the Office WLED at a comfortable brightness based on time of day whenever the Living Room light changes."
mode: restart
trigger:
  - platform: state
    entity_id: light.living_room_2
conditions: []
action:
  - delay: '00:00:02'
  - choose:
      - conditions:
          - condition: time
            after: '06:00:00'
            before: '18:00:00'
        sequence:
          - variables:
              office_brightness_pct: "{{ iif(is_state('light.wled','on') and state_attr('light.wled','brightness') is not none, (state_attr('light.wled','brightness') | float(0) / 255 * 100), 0) }}"
          - condition: template
            value_template: "{{ office_brightness_pct < 50 and (office_brightness_pct | round(0)) != 70 }}"
          - service: light.turn_on
            target:
              entity_id: light.wled
            data:
              brightness_pct: 70
      - conditions:
          - condition: or
            conditions:
              - condition: time
                after: '18:00:00'
                before: '23:59:59'
              - condition: time
                after: '00:00:00'
                before: '06:00:00'
        sequence:
          - variables:
              living_room_brightness_pct: "{{ iif(is_state('light.living_room_2','on') and state_attr('light.living_room_2','brightness') is not none, (state_attr('light.living_room_2','brightness') | float(0) / 255 * 100), 0) }}"
              office_brightness_pct: "{{ iif(is_state('light.wled','on') and state_attr('light.wled','brightness') is not none, (state_attr('light.wled','brightness') | float(0) / 255 * 100), 0) }}"
          - condition: template
            value_template: "{{ living_room_brightness_pct > 60 and (office_brightness_pct | round(0)) != 30 }}"
          - service: light.turn_on
            target:
              entity_id: light.wled
            data:
              brightness_pct: 30