# Home Assistant Entity Naming Research

**Date:** October 29, 2025  
**Purpose:** Understand HA entity naming patterns to improve entity resolution

---

## Key Findings

### 1. HA Does NOT Enforce Strict Naming Conventions

**Important:** Home Assistant does **not** enforce a strict naming convention. Instead:
- Each integration generates entity IDs based on its own logic
- Default names often include manufacturer/model information
- Users can customize entity IDs and friendly names
- Different integrations use different naming patterns

---

## How Integrations Generate Entity IDs

### General Pattern

Most integrations generate entity IDs using:
1. **Device name** (from manufacturer/model)
2. **unique_id** (hardware identifier from device)
3. **Integration-specific logic** (varies by integration)

**Common structure:**
```
<domain>.<device_name_normalized>_<unique_suffix>
```

Where:
- `domain`: Entity type (`light`, `sensor`, `switch`, etc.)
- `device_name_normalized`: Lowercase, underscores instead of spaces, special chars removed
- `unique_suffix`: Often a number or unique_id hash to ensure uniqueness

---

## Numbering Patterns in Entity IDs

### When Multiple Devices of Same Model Exist

When Home Assistant discovers multiple devices of the same model:

1. **First device**: Usually no number suffix
   - Example: `light.hue_color_downlight`

2. **Second+ devices**: Number appended for uniqueness
   - Example: `light.hue_color_downlight_2`, `light.hue_color_downlight_3`

3. **Complex scenarios**: Multiple numbers (integration-specific)
   - Example: `light.hue_color_downlight_1_6` (could be zone/group + index)
   - Example: `light.hue_color_downlight_2_2` (could be room number + device number)

### Hue Integration Specifics

Philips Hue integration often:
- Uses bridge/zone structure in numbering
- May include bridge ID in entity ID
- Numbering can be: `_1`, `_2`, `_1_2`, `_2_2` etc.
- Pattern: `<model>_<zone/bridge>_<device_index>`

**Examples from your system:**
- `light.hue_color_downlight_1_6` → Bridge/Zone 1, Device 6
- `light.hue_color_downlight_2_2` → Bridge/Zone 2, Device 2
- `light.hue_color_downlight_3` → Simple numbering (Device 3)
- `light.hue_color_downlight_4` → Simple numbering (Device 4)

---

## Device Name vs Entity ID

### Device Name (User-Friendly)
- Set by user or manufacturer
- Examples: "Office Front Left", "Master Back Left"
- Can be changed in HA UI
- Used for friendly display

### Entity ID (System Identifier)
- Generated by integration
- Immutable (must be changed manually)
- Uses normalized format (lowercase, underscores)
- Examples: `light.hue_color_downlight_1_6`, `light.hue_color_downlight_2_2`

### Key Insight

**The entity ID numbering may NOT match the device name numbering!**

- Device name: "Office Front Left" → might be "Office light 1" to user
- Entity ID: `light.hue_color_downlight_1_6` → number "1" in ID
- But another device might be:
  - Device name: "Office Back Right" → might be "Office light 2" to user  
  - Entity ID: `light.hue_color_downlight_2_2` → number "2" in ID

**This mismatch is the core problem!**

---

## Recommended Naming Patterns (User Best Practices)

While HA doesn't enforce it, the community recommends:

### Structure
```
<domain>.<location>_<device_type>_<identifier>
```

**Examples:**
- `light.office_lamp_1`
- `light.kitchen_ceiling_2`
- `sensor.bedroom_temperature`

### Best Practices
1. **Location first** - Helps with filtering and organization
2. **Device type** - Makes purpose clear
3. **Unique identifier** - Number or descriptive name
4. **Avoid brand names** - More flexible for device replacement
5. **Lowercase + underscores** - Required by HA

---

## Implications for Entity Resolution

### Current Challenge

Your entity resolution is trying to match:
- User query: "Office light 1" (expects numbered device)
- Device name: "Office Front Left" (no number in name)
- Entity ID: `light.hue_color_downlight_1_6` (has "1" but not "1" alone)

### The Problem

1. **Device names may not have numbers** - "Office Front Left" vs "Office light 1"
2. **Entity ID numbers may not match user numbering** - `_1_6` vs user's "light 1"
3. **Numbering schemes vary by integration** - Hue uses `_1_6`, `_2_2` vs simple `_1`, `_2`
4. **User may think of devices differently** - "Office light 1" might be the first office light they installed, not necessarily the one with "1" in entity ID

### Solution Approach

For entity resolution, we should:
1. **Match against device name first** - Most reliable (user-set or meaningful)
2. **Fallback to entity ID pattern matching** - But be aware of numbering mismatches
3. **Use location/area as primary filter** - Most consistent attribute
4. **Consider friendly_name** - Often matches user expectations better than entity_id

---

## Research Sources

1. [Home Assistant Naming Convention Guide (GitHub)](https://github.com/Trikos/Home-Assistant-Naming-Convention)
2. Home Assistant Community Forums - Naming best practices discussions
3. Home Assistant Developer Documentation - Entity naming guidelines

---

## Next Steps for Entity Resolution

Based on this research:

1. **Prioritize device_name and friendly_name** over entity_id for matching
2. **Understand that entity_id numbers may not match user expectations**
3. **Use location/area_id as primary filter** (most reliable)
4. **Consider HA's numbering patterns** when matching entity IDs:
   - Simple: `_1`, `_2`, `_3`
   - Complex: `_1_6`, `_2_2` (zone/device structure)
   - Extract the "user-facing" number from complex patterns

5. **Number extraction strategy:**
   - For simple patterns (`_1`, `_2`): Extract last number
   - For complex patterns (`_1_6`, `_2_2`): May need to extract first OR last number depending on integration
   - Consider all numbers in entity ID when matching

---

## Example: Your Hue Lights

Based on entity IDs in your system:

| Entity ID | Likely Meaning | User Expectation | Issue |
|-----------|----------------|------------------|-------|
| `light.hue_color_downlight_1_6` | Zone 1, Device 6 | "Office light 1" | Numbers don't align |
| `light.hue_color_downlight_2_2` | Zone 2, Device 2 | "Office light 2" | Matches by chance |
| `light.hue_color_downlight_3` | Device 3 | "Office light 3" | But in master_bedroom! |
| `light.hue_color_downlight_4` | Device 4 | "Office light 4" | But in master_bedroom! |

**The real issue:** Entity ID numbers represent Hue's internal numbering (bridge zones, device order), NOT the user's numbering (first office light, second office light, etc.).

**Solution:** Rely on **device_name** ("Office Front Left", "Office Back Right") and **location** (area_id: office) for matching, not entity_id numbers!

